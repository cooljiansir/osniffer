<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="product" content="Metro UI CSS Framework">
    <meta name="description" content="Simple responsive css framework">
    <meta name="author" content="Sergey S. Pimenov, Ukraine, Kiev">
    <meta name="keywords" content="js, css, metro, framework, windows 8, metro ui">

    <link href="css/metro-bootstrap.css" rel="stylesheet">
    <link href="css/metro-bootstrap-responsive.css" rel="stylesheet">
    <link href="css/iconFont.css" rel="stylesheet">
    <link href="css/docs.css" rel="stylesheet">
    <link href="css/local.css" rel="stylesheet">
    <link href="css/jquery.dataTables.css" rel="stylesheet">

    
    <link href="js/prettify/prettify.css" rel="stylesheet">

    <!-- Load JavaScript Libraries -->
    <script src="js/jquery/jquery.min.js"></script>
    <script src="js/jquery/jquery.widget.min.js"></script>
    <script src="js/jquery/jquery.mousewheel.js"></script>
    <script src="js/prettify/prettify.js"></script>

    <!-- Metro UI CSS JavaScript plugins -->
    <script src="js/load-metro.js"></script>

    <!-- Local JavaScript -->
    <script src="js/docs.js"></script>
    <script src="js/github.info.js"></script>
    <script src="js/jquery.dataTables.js"></script>



    <title>OpenWrt Sniffer</title>

    <style>
    </style>
</head>
<body class="metro" style="background-color: #efeae3">
    <header class="bg-dark" data-load="header.html"></header>
	<div class="container min-height">
	    <h1>Interfaces</h1>
            <table name="infstable" id="infstable" class="table striped bordered hovered">
                <thead>
                <tr>
                    <th class="text-left">Selected</th>
                    <th class="text-left">Device</th>
                    <th class="text-left">Description</th>
                    <th class="text-left">IP</th>
                    <th class="text-left">Packets</th>
                    <th class="text-left">Promiscuous Mode</th>
                </tr>
                </thead>

                <tbody>
                </tbody>
            </table>
	</div>
	<div class="container min-height">
	    <h1>Packages</h1>
	    <table name="pkgtable" id="pkgtable" class="table hovered">
                <thead>
                <tr>
                    <th class="text-left">No.</th>
                    <th class="text-left">Time</th>
                    <th class="text-left">Source</th>
                    <th class="text-left">Destination</th>
                    <th class="text-left">Protocol</th>
                    <th class="text-left">Length</th>
                    <th class="text-left">Info</th>
                </tr>
                </thead>
                <tbody>
		    <tr><td>1</td><td>0.00000</td><td>124.16.76.11</td><td>224.0.0.252</td><td>LLMNR</td><td>66</td><td>Standard query 0x6a66 A isatap</td></tr>
                </tbody>
            </table>
	</div>

    <div class="bg-dark" data-load="footer.html"></div>
    <script src="js/hitua.js"></script>
    <script >
        $(document).ready(function(){
     		$.getJSON( "/cgi-bin/OpenWrtSniffer?action=inter_list", function( data ) {
		    $("#infstable tbody").html("");
		    $.each(data,function(i,data_i){
			$ips="";
			$.each(data_i.ips,function(j,ip_j){
				$ips += ip_j.ip +"</br>";
			});
			$s1="";
			if(data_i.selected=="1")$s1="checked";
			$s2="";
			if(data_i.pmode=="1")$s2="checked";
			$("#infstable tbody").append("<tr><td><div class=\"input-control switch\"><label><input type=\"checkbox\" "+$s1+" /><span class=\"check\"></span></label></div></td><td>"+data_i.name+"</td><td class=\"right\">"+data_i.description+"</td><td class=\"right\">"+$ips+"</td><td class=\"right\">323</td><td class=\"right\"><div class=\"input-control switch\"><label><input type=\"checkbox\" "+$s2+"/><span class=\"check\"></span></label></div></td></tr>");
		    });
	            $("#infstable tbody tr td:first-child input[type='checkbox']").click(function(){
                    	name=$(this).parents("td").next().text();
                            $.getJSON( "/cgi-bin/OpenWrtSniffer?action=switch_select&name="+name, function( data ) {
                                    if(data.result!='success'){
                                            alert("failed");
                                    }
                            })
                            .fail(function(){
                                    alert("failed");
                            });
                    });
                    $("#infstable tbody tr td:last-child input[type='checkbox']").click(function(){
                            name=$(this).parents("td").prev().prev().prev().prev().text();
                            $.getJSON( "/cgi-bin/OpenWrtSniffer?action=switch_pmode&name="+name, function( data ) {
                                    if(data.result!='success'){
                                            alert("failed");
                                    }
                            })
                            .fail(function(){
                                    alert("failed");
                            });
                    });
		});
        });
    </script>
</body>
</html>
